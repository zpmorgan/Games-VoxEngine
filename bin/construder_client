#!/opt/perl/bin/perl
use common::sense;
use Games::VoxEngine;
use Games::VoxEngine::Logging;
use Games::VoxEngine::Client;

#vox_enable_log_categories ('all');
vox_enable_log_categories ('info', 'error', 'warn', 'chat');

Games::VoxEngine::Debug::init ("client");

our $game = eval { Games::VoxEngine::Client->new (auto_login => 'foo') };
if ($@) {
   vox_log (error => "Couldn't initialized client: %s", $@);
   exit 1;
}

our $in_ex;
$game->set_exception_cb (sub {
   my ($ex, $ev) = @_;
   return if $in_ex;
   local $in_ex = 1;
   vox_log (error => "exception in client (%s): %s", $ev, $ex);
   $game->{front}->msg ("Fatal Error: Exception in client caught: $ev: $ex");
});

$game->start;
